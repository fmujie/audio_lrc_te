<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>
<body>
    <audio id="audio_element" style="opacity: 0.5;" controls>
        <source src="audio/newboy.mp3" type="audio/mpeg">
    </audio>
    <span id="curIntro" style="display: none">穿新衣吧 剪新发型呀 轻松一下 Wds98 打扮漂亮 18岁是天堂 我们的生活 甜得像糖 穿新衣吧 剪新发型呀 轻松一下 Wds98 以后的路不再会有痛苦 我们的未来该有多酷 </span>
    <button type="button" id="play_btn"  class="btn btn-primary">Reload</button>
    <button type="button" id="tag_btn" class="btn btn-primary">Tag</button>

    <script>
        let data = $("#curIntro").html().replace(/\s*/g,"").split('')
        let index = 0
        let lrcArr = []
        let currentTime = null
        let tagBtn = document.getElementById('tag_btn')
        let palyBtn = document.getElementById('play_btn')
        let audio = document.getElementById('audio_element');
        palyBtn.onclick = function () {
            if (audio.paused || audio.play) {
                audio.load();
                audio.play()
            }
        }
        
        $('audio').bind('ended', function(){
            console.log('ended')
            console.log(lrcArr)
        })

        tagBtn.onclick = function () {
            currentTime = audio.currentTime.toFixed(2)
            let m = parseInt(currentTime / 60 % 60).toString()
            let s = parseInt(currentTime % 60).toString()
            let ms = (currentTime % 60).toFixed(2).toString().slice(-2)
            m.length != 2 ? m = '0' + m : m
            s.length != 2 ? s = '0' + s : s
            console.log('[' + m + ':' + s + '.' + ms + '] ' + data[index]);
            typeof(data[index]) == 'string' ? lrcArr.push('[' + m + ':' + s + '.' + ms + '] ' + data[index++]) : null
        }
        
    </script>
</body>
</html>